<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Booking - Jayvee Hall of Mansion</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f4f4;
      padding: 20px;
    }
    .booking-container {
      background: white;
      max-width: 500px;
      margin: auto;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    .booking-container h2 {
      text-align: center;
    }
    .booking-container input, 
    .booking-container select {
      width: 100%;
      padding: 10px;
      margin: 8px 0;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    .booking-container button {
      width: 100%;
      padding: 10px;
      margin-top: 10px;
      border: none;
      background: #333;
      color: white;
      font-size: 16px;
      cursor: pointer;
      border-radius: 5px;
    }
    .booking-container button:hover {
      background: #555;
    }
    .receipt {
      margin-top: 20px;
      padding: 10px;
      border: 2px dashed #999;
      background: #fafafa;
    }
  </style>
</head>
<body>

<div class="booking-container" id="bookingSection">
  <h2>Online Reservation</h2>
  <form id="bookingForm">
    <label>Selected Room:</label>
    <input type="text" id="roomName" name="roomName" readonly required>

    <label>Name:</label>
    <input type="text" name="fullName" placeholder="Enter Full Name" required>

    <label>Number of People:</label>
    <input type="number" name="numPeople" required>

    <label>Select Date of Stay:</label>
    <input type="date" name="dateStay" required>

    <label>Number of Days to Stay:</label>
    <input type="number" name="numDays" required>

    <label>Payment Method:</label>
    <select name="paymentMethod" id="paymentMethod" required>
      <option value="">Select Payment Method</option>
      <option value="Cash">Cash</option>
      <option value="Online">Online Payment</option>
    </select>

    <div id="bankOptions" style="display:none;">
      <label>Select Bank:</label>
      <select name="bankSelect">
        <option value="BDO">BDO</option>
        <option value="Landbank">Landbank</option>
        <option value="BPI">BPI</option>
      </select>
    </div>

    <button type="submit">Confirm Booking</button>
  </form>

  <div id="receipt" class="receipt" style="display:none;">
    <h3>Booking Confirmation</h3>
    <p><strong>Room:</strong> <span id="rRoom"></span></p>
    <p><strong>Name:</strong> <span id="rName"></span></p>
    <p><strong>Guests:</strong> <span id="rPeople"></span></p>
    <p><strong>Date of Stay:</strong> <span id="rDate"></span></p>
    <p><strong>Number of Days:</strong> <span id="rDays"></span></p>
    <p><strong>Payment:</strong> <span id="rPayment"></span></p>
    <p><strong>Bank:</strong> <span id="rBank"></span></p>
    <button id="downloadReceipt">Download as PNG</button>
  </div>
</div>

<script>
  // Load selected room from URL
  const params = new URLSearchParams(window.location.search);
  document.getElementById("roomName").value = params.get("room") || "No Room Selected";

  // Show bank options for online payment
  document.getElementById("paymentMethod").addEventListener("change", function() {
    document.getElementById("bankOptions").style.display = this.value === "Online" ? "block" : "none";
  });

  // Handle booking form submission
  document.getElementById("bookingForm").addEventListener("submit", function(e) {
    e.preventDefault();

    const formData = new FormData(this);
    const booking = {
      roomName: formData.get("roomName"),
      fullName: formData.get("fullName"),
      numPeople: formData.get("numPeople"),
      dateStay: formData.get("dateStay"),
      numDays: formData.get("numDays"),
      paymentMethod: formData.get("paymentMethod"),
      bank: formData.get("bankSelect") || "N/A",
      timestamp: new Date().toLocaleString()
    };

    // Save to localStorage for Admin Panel
    const bookings = JSON.parse(localStorage.getItem("bookings")) || [];
    bookings.push(booking);
    localStorage.setItem("bookings", JSON.stringify(bookings));

    // Display Receipt
    document.getElementById("rRoom").innerText = booking.roomName;
    document.getElementById("rName").innerText = booking.fullName;
    document.getElementById("rPeople").innerText = booking.numPeople;
    document.getElementById("rDate").innerText = booking.dateStay;
    document.getElementById("rDays").innerText = booking.numDays;
    document.getElementById("rPayment").innerText = booking.paymentMethod;
    document.getElementById("rBank").innerText = booking.bank;
    document.getElementById("receipt").style.display = "block";
  });

  // Download booking as PNG
  document.getElementById("downloadReceipt").addEventListener("click", function() {
    html2canvas(document.getElementById("receipt")).then(canvas => {
      const link = document.createElement("a");
      link.download = "BookingReceipt.png";
      link.href = canvas.toDataURL();
      link.click();
    });
  });
</script>

</body>
      </html>
