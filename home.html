<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Jayvee Hall of Mansion - Home</title>
  <link rel="stylesheet" href="style.css">

  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', Arial, sans-serif;
      background: url('assets/bgindex.jpg') no-repeat center center fixed;
      background-size: cover;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      color: #fff;
    }

    header {
      background: rgba(0,0,0,0.7);
      text-align: center;
      padding: 20px;
      font-size: 28px;
      font-weight: bold;
      letter-spacing: 1px;
    }

    .home-container {
      flex: 1;
      max-width: 1200px;
      margin: 30px auto;
      background: rgba(0,0,0,0.55);
      padding: 25px;
      border-radius: 15px;
      text-align: center;
      box-shadow: 0 0 20px rgba(0,0,0,0.4);
      animation: fadeIn 0.8s;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(15px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .room-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .room-card {
      background: rgba(255,255,255,0.95);
      color: #222;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 5px 15px rgba(0,0,0,0.3);
      transition: 0.3s;
      display: flex;
      flex-direction: column;
    }

    .room-card img {
      width: 100%;
      height: 180px;
      object-fit: cover;
    }

    .room-card:hover {
      transform: translateY(-5px);
    }

    .room-card h3 { margin: 12px 0 5px; }
    .room-card p { margin: 0 0 10px; font-weight: bold; }

    .card-buttons { margin-bottom: 15px; }
    .card-buttons button {
      margin: 5px;
      padding: 8px 14px;
      border: none;
      cursor: pointer;
      border-radius: 6px;
      background: #333;
      color: white;
      font-size: 14px;
      transition: 0.2s;
    }
    .card-buttons button:hover { background: #555; }

    /* Modal */
    .modal {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.7);
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }

    .modal-content {
      background: white;
      padding: 25px;
      border-radius: 12px;
      width: 420px;
      max-width: 90%;
      text-align: center;
      position: relative;
      animation: fadeIn 0.4s;
    }

    .modal-content h3 { color: #333; }
    .modal-content p { color: #555; }

    .close {
      position: absolute;
      top: 10px; right: 15px;
      font-size: 22px;
      cursor: pointer;
      color: #333;
    }

    /* Notifications */
    #notifications {
      position: fixed;
      top: 20px;
      right: 20px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      z-index: 2000;
    }

    .notif {
      background: rgba(0,0,0,0.85);
      color: #fff;
      padding: 12px 20px;
      border-radius: 8px;
      min-width: 220px;
      text-align: center;
      animation: slideIn 0.5s;
    }

    .notif.approved { background: rgba(40,167,69,0.9); }
    .notif.rejected { background: rgba(220,53,69,0.9); }

    @keyframes slideIn {
      from { opacity: 0; transform: translateX(50px); }
      to { opacity: 1; transform: translateX(0); }
    }

    /* Booking Status */
    .booking-status {
      background: rgba(255,255,255,0.95);
      color: black;
      margin: 15px auto;
      padding: 15px;
      border-radius: 10px;
      max-width: 600px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.3);
    }

    @media (max-width: 768px) {
      header { font-size: 22px; }
      .room-card img { height: 150px; }
    }
  </style>
</head>
<body>

<header>Welcome to Jayvee Hall of Mansion</header>

<div class="home-container">
  <p>Experience luxury and comfort in the heart of Malungon, Sarangani. Explore our elegant rooms and choose the perfect stay for you.</p>

  <!-- Grid Layout for Rooms -->
  <div class="room-grid">
    <div class="room-card">
      <img src="assets/room1.jpg" alt="Deluxe Room">
      <h3>Room 101 - Deluxe Room</h3>
      <p>₱3,500 / night</p>
      <div class="card-buttons">
        <button onclick="showRoomDetails(0)">View Details</button>
        <button onclick="bookRoom('Room 101 - Deluxe Room')">Book Now</button>
      </div>
    </div>

    <div class="room-card">
      <img src="assets/room2.jpg" alt="Executive Suite">
      <h3>Room 102 - Executive Suite</h3>
      <p>₱5,200 / night</p>
      <div class="card-buttons">
        <button onclick="showRoomDetails(1)">View Details</button>
        <button onclick="bookRoom('Room 102 - Executive Suite')">Book Now</button>
      </div>
    </div>

    <div class="room-card">
      <img src="assets/room3.jpg" alt="Family Room">
      <h3>Room 103 - Family Room</h3>
      <p>₱4,000 / night</p>
      <div class="card-buttons">
        <button onclick="showRoomDetails(2)">View Details</button>
        <button onclick="bookRoom('Room 103 - Family Room')">Book Now</button>
      </div>
    </div>

    <div class="room-card">
      <img src="assets/room4.jpg" alt="Presidential Suite">
      <h3>Room 104 - Presidential Suite</h3>
      <p>₱8,000 / night</p>
      <div class="card-buttons">
        <button onclick="showRoomDetails(3)">View Details</button>
        <button onclick="bookRoom('Room 104 - Presidential Suite')">Book Now</button>
      </div>
    </div>
  </div>

  <h3>Your Bookings:</h3>
  <div id="userBookings"></div>
</div>

<!-- Modal for Room Details -->
<div id="roomModal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="closeRoomModal()">&times;</span>
    <h3 id="roomTitle"></h3>
    <p id="roomDesc"></p>
    <p id="roomPrice"></p>
    <button onclick="proceedToBooking()">Interested</button>
    <button onclick="closeRoomModal()">Not Interested</button>
  </div>
</div>

<!-- Notifications -->
<div id="notifications"></div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
  import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyCdMcz7H8k5QjQikD6ZAlf7kHw7BbUBO70",
    authDomain: "jayveehallofmansion.firebaseapp.com",
    databaseURL: "https://jayveehallofmansion-default-rtdb.firebaseio.com",
    projectId: "jayveehallofmansion",
    storageBucket: "jayveehallofmansion.firebasestorage.app",
    messagingSenderId: "596113378063",
    appId: "1:596113378063:web:ae6fa08175627727660c7a",
    measurementId: "G-LY9QYJKZMX"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  const roomDetails = [
    { title: "Room 101 - Deluxe Room", desc: "Our Deluxe Room offers comfort and elegance with a cozy king-size bed, complimentary Wi-Fi, and a modern bathroom.", price: "₱3,500 / night" },
    { title: "Room 102 - Executive Suite", desc: "Executive Suite provides a luxurious experience with spacious interiors, a private lounge area, and premium amenities.", price: "₱5,200 / night" },
    { title: "Room 103 - Family Room", desc: "Family Room is designed for groups and families, featuring multiple beds, entertainment options, and ample space.", price: "₱4,000 / night" },
    { title: "Room 104 - Presidential Suite", desc: "The Presidential Suite is our finest offering with a majestic view, large living room, Jacuzzi, and VIP services.", price: "₱8,000 / night" }
  ];

  let selectedRoom = "";

  function showRoomDetails(index) {
    selectedRoom = roomDetails[index].title;
    document.getElementById("roomTitle").innerText = roomDetails[index].title;
    document.getElementById("roomDesc").innerText = roomDetails[index].desc;
    document.getElementById("roomPrice").innerText = roomDetails[index].price;
    document.getElementById("roomModal").style.display = "flex";
  }

  function closeRoomModal() {
    document.getElementById("roomModal").style.display = "none";
  }

  function proceedToBooking() {
    window.location.href = `booking.html?room=${encodeURIComponent(selectedRoom)}`;
  }

  function bookRoom(roomName) {
    window.location.href = `booking.html?room=${encodeURIComponent(roomName)}`;
  }

  // Load notifications
  function loadNotifications() {
    const bookings = JSON.parse(localStorage.getItem("bookings")) || [];
    const notifContainer = document.getElementById("notifications");
    notifContainer.innerHTML = "";

    bookings.forEach(b => {
      if (b.status === "Approved" || b.status === "Rejected") {
        const div = document.createElement("div");
        div.className = `notif ${b.status === "Approved" ? "approved" : "rejected"}`;
        div.innerText = `Your booking for ${b.room} was ${b.status}`;
        notifContainer.appendChild(div);
      }
    });

    setTimeout(() => notifContainer.innerHTML = "", 5000);
  }

  // Show user's bookings
  const userEmail = localStorage.getItem("userEmail");
  const userBookingsDiv = document.getElementById("userBookings");

  function renderBooking(id, booking) {
    return `
      <div class="booking-status">
        <strong>Room:</strong> ${booking.room}<br>
        <strong>Date:</strong> ${booking.date || "N/A"}<br>
        <strong>Status:</strong> ${booking.status}
      </div>
    `;
  }

  if (userEmail) {
    const bookingsRef = ref(db, 'bookings');
    onValue(bookingsRef, (snapshot) => {
      userBookingsDiv.innerHTML = "";
      const data = snapshot.val();
      const seenRooms = new Set();

      for (let key in data) {
        const booking = data[key];
        if (booking.email === userEmail && !seenRooms.has(booking.room)) {
          seenRooms.add(booking.room);
          userBookingsDiv.innerHTML += renderBooking(key, booking);
        }
      }
    });
  } else {
    userBookingsDiv.innerHTML = "<p>No bookings found. Please book a room.</p>";
  }

  window.onload = loadNotifications;
</script>

</body>
        </html>
